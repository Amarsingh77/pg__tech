import{b as L,u as $,r,R as q,a as w,j as e,e as I,m as h,U as S,f as U,g as k,h as C}from"./index-CJ8kiAx1.js";const D=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],F=L("user-plus",D),B=()=>{const{user:f,token:c}=$(),[o,j]=r.useState("security"),[a,m]=r.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[u,i]=r.useState({type:"",message:""}),[N,v]=r.useState(!1),[n,T]=r.useState([]),[l,x]=r.useState({email:"",password:"",mobile:""}),[b,g]=r.useState({type:"",message:""}),[P,A]=r.useState(!1);r.useEffect(()=>{o==="team"&&p()},[o,p]);const p=q.useCallback(async()=>{try{const s=await fetch(w.admins,{headers:{Authorization:`Bearer ${c}`}});if(!s.ok)throw new Error("Failed to fetch admins");const t=await s.json();T(t)}catch(s){console.error("Error fetching admins:",s)}},[c]),z=async s=>{if(s.preventDefault(),i({type:"",message:""}),a.newPassword!==a.confirmPassword){i({type:"error",message:"New passwords do not match"});return}v(!0);try{const t=await fetch(w.changePassword,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({currentEmail:f.email,currentPassword:a.currentPassword,newPassword:a.newPassword})});if(!t.ok){const y=await t.text();throw new Error(y||"Failed to update password")}const d=await t.json();d.success?(i({type:"success",message:d.message}),m({currentPassword:"",newPassword:"",confirmPassword:""})):i({type:"error",message:d.message})}catch{i({type:"error",message:"Failed to update password"})}finally{v(!1)}},E=async s=>{s.preventDefault(),g({type:"",message:""}),A(!0);try{const t=await fetch(w.addAdmin,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify(l)});if(!t.ok){const y=await t.text();throw new Error(y||"Failed to add admin")}const d=await t.json();d.success?(g({type:"success",message:d.message}),x({email:"",password:"",mobile:""}),p()):g({type:"error",message:d.message})}catch{g({type:"error",message:"Failed to add admin"})}finally{A(!1)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-8",children:"Settings"}),e.jsxs("div",{className:"flex space-x-4 mb-8 border-b border-gray-700 pb-1",children:[e.jsxs("button",{onClick:()=>j("security"),className:`pb-3 px-4 font-medium transition-colors relative ${o==="security"?"text-blue-400":"text-gray-400 hover:text-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:18}),"Security"]}),o==="security"&&e.jsx(h.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-400"})]}),e.jsxs("button",{onClick:()=>j("team"),className:`pb-3 px-4 font-medium transition-colors relative ${o==="team"?"text-blue-400":"text-gray-400 hover:text-white"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:18}),"Team Management"]}),o==="team"&&e.jsx(h.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-400"})]})]}),o==="security"&&e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl p-8 border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(U,{className:"text-blue-400"}),"Change Password"]}),u.message&&e.jsxs("div",{className:`p-4 rounded-lg mb-6 flex items-center gap-3 ${u.type==="success"?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-red-500/10 text-red-400 border border-red-500/20"}`,children:[u.type==="success"?e.jsx(k,{size:20}):e.jsx(C,{size:20}),u.message]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:a.currentPassword,onChange:s=>m({...a,currentPassword:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:a.newPassword,onChange:s=>m({...a,newPassword:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:a.confirmPassword,onChange:s=>m({...a,confirmPassword:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:N,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50",children:N?"Updating...":"Update Password"})]})]})}),o==="team"&&e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-800 rounded-xl p-8 border border-gray-700 h-fit",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(F,{className:"text-blue-400"}),"Add New Admin"]}),b.message&&e.jsxs("div",{className:`p-4 rounded-lg mb-6 flex items-center gap-3 ${b.type==="success"?"bg-green-500/10 text-green-400 border border-green-500/20":"bg-red-500/10 text-red-400 border border-red-500/20"}`,children:[b.type==="success"?e.jsx(k,{size:20}):e.jsx(C,{size:20}),b.message]}),e.jsx("div",{className:"mb-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg text-blue-300 text-sm",children:e.jsxs("p",{children:["Current Admins: ",e.jsx("span",{className:"font-bold",children:n.length})," / 10"]})}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:l.email,onChange:s=>x({...l,email:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"text",value:l.mobile,onChange:s=>x({...l,mobile:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",placeholder:"+91 9876543210"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Initial Password"}),e.jsx("input",{type:"password",value:l.password,onChange:s=>x({...l,password:s.target.value}),className:"w-full bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:border-blue-500",required:!0})]}),e.jsx("button",{type:"submit",disabled:P||n.length>=10,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:P?"Adding...":n.length>=10?"Limit Reached":"Add Admin"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl p-8 border border-gray-700",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(S,{className:"text-blue-400"}),"Admin Team"]}),e.jsxs("div",{className:"space-y-4",children:[n.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-700/50 rounded-lg border border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:s.email[0].toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("span",{className:"capitalize",children:s.role.replace("_"," ")}),s.mobile&&e.jsxs("span",{children:["â€¢ ",s.mobile]})]})]})]}),s.email===f?.email&&e.jsx("span",{className:"px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full border border-blue-500/30",children:"You"})]},s.id)),n.length===0&&e.jsx("p",{className:"text-gray-400 text-center py-4",children:"Loading team..."})]})]})]})]})};export{B as default};
