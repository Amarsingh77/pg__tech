import{b as y,u as z,r as l,j as e,d as $,C as D,M as P,P as T,T as L,F as M,X as F,a as i}from"./index-CJ8kiAx1.js";const I=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],O=y("eye",I);const _=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],B=y("save",_),V=()=>{const{token:n}=z(),[N,o]=l.useState([]),[c,f]=l.useState(""),[v,w]=l.useState(!0),[t,g]=l.useState(null),[C,u]=l.useState(!1),[d,p]=l.useState("");l.useEffect(()=>{(async()=>{try{const a=await fetch(i.enrollments,{headers:{Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error("Failed to fetch enrollments");const r=await a.json();o(Array.isArray(r)?r:r.data||[])}catch(a){console.error("Error fetching enrollments:",a)}finally{w(!1)}})()},[n]);const k=async(s,a)=>{try{(await fetch(`${i.enrollments}/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({status:a})})).ok?o(h=>h.map(m=>m.id===s?{...m,status:a}:m)):alert("Failed to update status")}catch(r){console.error("Error updating status:",r),alert("Error updating status")}},E=async s=>{if(window.confirm("Are you sure you want to delete this enrollment? This action cannot be undone."))try{(await fetch(`${i.enrollments}/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}})).ok?o(r=>r.filter(h=>h.id!==s)):alert("Failed to delete enrollment")}catch(a){console.error("Error deleting enrollment:",a),alert("Error deleting enrollment")}},S=s=>{g(s),p(s.notes||""),u(!0)},x=()=>{g(null),u(!1)},A=async()=>{if(t)try{(await fetch(`${i.enrollments}/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({notes:d})})).ok?(o(a=>a.map(r=>r.id===t.id?{...r,notes:d}:r)),alert("Notes saved successfully"),x()):alert("Failed to save notes")}catch(s){console.error("Error saving notes:",s),alert("Error saving notes")}},b=N.filter(s=>s.name?.toLowerCase().includes(c.toLowerCase())||s.email?.toLowerCase().includes(c.toLowerCase())||s.courseName?.toLowerCase().includes(c.toLowerCase())),j=s=>{switch(s){case"Approved":return"text-green-400 bg-green-500/20 border-green-500/30";case"Rejected":return"text-red-400 bg-red-500/20 border-red-500/30";case"Completed":return"text-blue-400 bg-blue-500/20 border-blue-500/30";default:return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30"}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-3xl font-bold text-white",children:"Student Enrollments"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search students...",value:c,onChange:s=>f(s.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-4 py-2 text-white focus:outline-none focus:border-blue-500"})]})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl overflow-hidden border border-gray-700 shadow-lg",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-gray-300",children:[e.jsx("thead",{className:"bg-gray-700 text-gray-100 uppercase text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Student Name"}),e.jsx("th",{className:"p-4",children:"Contact Info"}),e.jsx("th",{className:"p-4",children:"Course"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-8 text-center",children:"Loading..."})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"p-8 text-center text-gray-500",children:"No enrollments found."})}):b.map(s=>e.jsxs("tr",{className:"hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-4 font-medium text-white",children:[s.name,e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1",children:[e.jsx(D,{size:10}),new Date(s.enrollmentDate||s.createdAt).toLocaleDateString()]})]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{size:14,className:"text-blue-400"}),s.email]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{size:14,className:"text-green-400"}),s.phone]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"bg-gray-700 px-2 py-1 rounded text-sm text-white",children:s.courseName||s.course})}),e.jsx("td",{className:"p-4",children:e.jsxs("select",{value:s.status||"Pending",onChange:a=>k(s.id,a.target.value),className:`text-xs font-bold rounded-lg px-2 py-1 border outline-none cursor-pointer ${j(s.status||"Pending")}`,children:[e.jsx("option",{value:"Pending",className:"bg-gray-800 text-gray-300",children:"Pending"}),e.jsx("option",{value:"Approved",className:"bg-gray-800 text-green-400",children:"Approved"}),e.jsx("option",{value:"Rejected",className:"bg-gray-800 text-red-400",children:"Rejected"}),e.jsx("option",{value:"Completed",className:"bg-gray-800 text-blue-400",children:"Completed"})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S(s),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-600 rounded-lg transition-colors",title:"View Details & Notes",children:e.jsx(O,{size:18})}),e.jsx("button",{onClick:()=>E(s.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete",children:e.jsx(L,{size:18})})]})})]},s.id))})]})})}),C&&t&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl w-full max-w-2xl border border-gray-700 shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700 flex justify-between items-center bg-gray-900/50",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(M,{className:"text-blue-500"}),"Enrollment Details"]}),e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(F,{size:24})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-gray-500 text-sm uppercase tracking-wider mb-3 font-semibold",children:"Student Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Full Name"}),e.jsx("span",{className:"text-white font-medium text-lg",children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Email Address"}),e.jsx("a",{href:`mailto:${t.email}`,className:"text-blue-400 hover:underline",children:t.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Phone Number"}),e.jsx("a",{href:`tel:${t.phone}`,className:"text-green-400 hover:underline",children:t.phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-gray-500 text-sm uppercase tracking-wider mb-3 font-semibold",children:"Course Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Course Name"}),e.jsx("span",{className:"text-white font-medium text-lg bg-gray-700/50 px-3 py-1 rounded inline-block",children:t.courseName||t.course})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Enrollment Date"}),e.jsx("span",{className:"text-white",children:new Date(t.enrollmentDate||t.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 text-sm block",children:"Current Status"}),e.jsx("span",{className:`inline-block px-2 py-1 rounded text-sm font-bold border ${j(t.status||"Pending")}`,children:t.status||"Pending"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-6",children:[e.jsx("label",{className:"text-gray-500 text-sm uppercase tracking-wider mb-3 font-semibold block",children:"Admin Notes"}),e.jsx("textarea",{value:d,onChange:s=>p(s.target.value),placeholder:"Add internal notes about this student...",className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-4 text-white focus:outline-none focus:border-blue-500 min-h-[150px]"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"These notes are only visible to administrators."})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900/50 flex justify-end gap-3",children:[e.jsx("button",{onClick:x,className:"px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:A,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(B,{size:18}),"Save Notes"]})]})]})})]})};export{V as default};
